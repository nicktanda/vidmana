<div class="container mx-auto px-4 py-8 max-w-4xl">
  <div class="bg-white rounded-lg shadow-lg p-8">
    <div class="flex justify-between items-start mb-6">
      <div>
        <h1 class="text-3xl font-bold mb-2"><%= @story.title %></h1>
        <div class="flex gap-4 text-sm text-gray-500">
          <span>Created: <%= @story.created_at.strftime("%B %d, %Y at %I:%M %p") %></span>
          <span class="px-2 py-1 rounded bg-blue-100 text-blue-800">
            <%= pluralize(@story.characters.count, 'character') %>
          </span>
          <span class="px-2 py-1 rounded bg-green-100 text-green-800">
            <%= pluralize(@story.beats.count, 'beat') %>
          </span>
        </div>
      </div>
      <div class="flex gap-2">
        <%= link_to "Edit", edit_story_path(@story), class: "bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" %>
        <%= link_to "Delete", @story, data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" %>
      </div>
    </div>

    <div class="prose max-w-none">
      <h2 class="text-xl font-semibold mb-2">Description</h2>
      <p class="text-gray-700 mb-6 whitespace-pre-wrap"><%= @story.description %></p>

      <% if @story.prompt.present? %>
        <h2 class="text-xl font-semibold mb-2">Original Prompt</h2>
        <p class="text-gray-700 mb-6 whitespace-pre-wrap bg-gray-50 border border-gray-200 rounded-lg p-4"><%= @story.prompt %></p>
      <% end %>

      <% if @story.characters.any? %>
        <h2 class="text-xl font-semibold mb-4 mt-8">Characters</h2>
        <div class="grid gap-3 mb-6">
          <% @story.characters.each do |character| %>
            <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
              <h3 class="font-semibold text-lg">
                <%= character.name %>
                <% if character.role.present? %>
                  <span class="text-sm text-purple-600 ml-2">(<%= character.role %>)</span>
                <% end %>
              </h3>
              <p class="text-gray-700 mt-2"><%= character.description %></p>
            </div>
          <% end %>
        </div>
      <% end %>

      <% if @story.locations.any? %>
        <h2 class="text-xl font-semibold mb-4 mt-8">Locations</h2>
        <div class="grid gap-3 mb-6">
          <% @story.locations.each do |location| %>
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
              <h3 class="font-semibold text-lg">
                <%= location.name %>
                <% if location.location_type.present? %>
                  <span class="text-sm text-blue-600 ml-2">(<%= location.location_type %>)</span>
                <% end %>
              </h3>
              <p class="text-gray-700 mt-2"><%= location.description %></p>
            </div>
          <% end %>
        </div>
      <% end %>

      <% if @story.beats.any? %>
        <h2 class="text-xl font-semibold mb-4 mt-8">Story Beats</h2>
        <div class="space-y-3 mb-6">
          <% @story.beats.order(:order_index).each_with_index do |beat, index| %>
            <div class="flex gap-3">
              <div class="flex-shrink-0">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                  <span class="text-sm font-bold text-white"><%= index + 1 %></span>
                </div>
              </div>
              <div class="flex-1 bg-green-50 p-4 rounded-lg border border-green-200">
                <h3 class="font-semibold text-lg"><%= beat.title %></h3>
                <p class="text-gray-700 mt-2"><%= beat.description %></p>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="mt-8 pt-6 border-t">
      <%= link_to "â† Back to Stories", stories_path, class: "text-blue-500 hover:text-blue-700" %>
    </div>
  </div>
</div>
